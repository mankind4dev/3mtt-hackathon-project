import mongoose from "mongoose";

const agentSchema = new mongoose.Schema(
  {
    title: {
      type: String,
      required: true,
      enum: ["Mr", "Mrs", "Miss"],
    },
    firstName: {
      type: String,
      required: true,
    },
    middleName: {
      type: String,
      required: true,
    },
    lastName: {
      type: String,
      required: true,
    },
    nationality: {
      type: String,
      enum: [
        { country: "Afghanistan", shortName: "AF" },
        { country: "Albania", shortName: "AL" },
        { country: "Algeria", shortName: "DZ" },
        { country: "Andorra", shortName: "AD" },
        { country: "Angola", shortName: "AO" },
        { country: "Antigua and Barbuda", shortName: "AG" },
        { country: "Argentina", shortName: "AR" },
        { country: "Armenia", shortName: "AM" },
        { country: "Australia", shortName: "AU" },
        { country: "Austria", shortName: "AT" },
        { country: "Azerbaijan", shortName: "AZ" },
        { country: "Bahamas", shortName: "BS" },
        { country: "Bahrain", shortName: "BH" },
        { country: "Bangladesh", shortName: "BD" },
        { country: "Barbados", shortName: "BB" },
        { country: "Belarus", shortName: "BY" },
        { country: "Belgium", shortName: "BE" },
        { country: "Belize", shortName: "BZ" },
        { country: "Benin", shortName: "BJ" },
        { country: "Bhutan", shortName: "BT" },
        { country: "Bolivia", shortName: "BO" },
        { country: "Bosnia and Herzegovina", shortName: "BA" },
        { country: "Botswana", shortName: "BW" },
        { country: "Brazil", shortName: "BR" },
        { country: "Brunei", shortName: "BN" },
        { country: "Bulgaria", shortName: "BG" },
        { country: "Burkina Faso", shortName: "BF" },
        { country: "Burundi", shortName: "BI" },
        { country: "Cabo Verde", shortName: "CV" },
        { country: "Cambodia", shortName: "KH" },
        { country: "Cameroon", shortName: "CM" },
        { country: "Canada", shortName: "CA" },
        { country: "Central African Republic", shortName: "CF" },
        { country: "Chad", shortName: "TD" },
        { country: "Chile", shortName: "CL" },
        { country: "China", shortName: "CN" },
        { country: "Colombia", shortName: "CO" },
        { country: "Comoros", shortName: "KM" },
        { country: "Congo (Congo-Brazzaville)", shortName: "CG" },
        { country: "Congo (Democratic Republic of the)", shortName: "CD" },
        { country: "Costa Rica", shortName: "CR" },
        { country: "Croatia", shortName: "HR" },
        { country: "Cuba", shortName: "CU" },
        { country: "Cyprus", shortName: "CY" },
        { country: "Czech Republic", shortName: "CZ" },
        { country: "Denmark", shortName: "DK" },
        { country: "Djibouti", shortName: "DJ" },
        { country: "Dominica", shortName: "DM" },
        { country: "Dominican Republic", shortName: "DO" },
        { country: "Ecuador", shortName: "EC" },
        { country: "Egypt", shortName: "EG" },
        { country: "El Salvador", shortName: "SV" },
        { country: "Equatorial Guinea", shortName: "GQ" },
        { country: "Eritrea", shortName: "ER" },
        { country: "Estonia", shortName: "EE" },
        { country: "Eswatini", shortName: "SZ" },
        { country: "Ethiopia", shortName: "ET" },
        { country: "Fiji", shortName: "FJ" },
        { country: "Finland", shortName: "FI" },
        { country: "France", shortName: "FR" },
        { country: "Gabon", shortName: "GA" },
        { country: "Gambia", shortName: "GM" },
        { country: "Georgia", shortName: "GE" },
        { country: "Germany", shortName: "DE" },
        { country: "Ghana", shortName: "GH" },
        { country: "Greece", shortName: "GR" },
        { country: "Grenada", shortName: "GD" },
        { country: "Guatemala", shortName: "GT" },
        { country: "Guinea", shortName: "GN" },
        { country: "Guinea-Bissau", shortName: "GW" },
        { country: "Guyana", shortName: "GY" },
        { country: "Haiti", shortName: "HT" },
        { country: "Honduras", shortName: "HN" },
        { country: "Hungary", shortName: "HU" },
        { country: "Iceland", shortName: "IS" },
        { country: "India", shortName: "IN" },
        { country: "Indonesia", shortName: "ID" },
        { country: "Iran", shortName: "IR" },
        { country: "Iraq", shortName: "IQ" },
        { country: "Ireland", shortName: "IE" },
        { country: "Israel", shortName: "IL" },
        { country: "Italy", shortName: "IT" },
        { country: "Jamaica", shortName: "JM" },
        { country: "Japan", shortName: "JP" },
        { country: "Jordan", shortName: "JO" },
        { country: "Kazakhstan", shortName: "KZ" },
        { country: "Kenya", shortName: "KE" },
        { country: "Kiribati", shortName: "KI" },
        { country: "Korea (North)", shortName: "KP" },
        { country: "Korea (South)", shortName: "KR" },
        { country: "Kuwait", shortName: "KW" },
        { country: "Kyrgyzstan", shortName: "KG" },
        { country: "Laos", shortName: "LA" },
        { country: "Latvia", shortName: "LV" },
        { country: "Lebanon", shortName: "LB" },
        { country: "Lesotho", shortName: "LS" },
        { country: "Liberia", shortName: "LR" },
        { country: "Libya", shortName: "LY" },
        { country: "Liechtenstein", shortName: "LI" },
        { country: "Lithuania", shortName: "LT" },
        { country: "Luxembourg", shortName: "LU" },
        { country: "Madagascar", shortName: "MG" },
        { country: "Malawi", shortName: "MW" },
        { country: "Malaysia", shortName: "MY" },
        { country: "Maldives", shortName: "MV" },
        { country: "Mali", shortName: "ML" },
        { country: "Malta", shortName: "MT" },
        { country: "Marshall Islands", shortName: "MH" },
        { country: "Mauritania", shortName: "MR" },
        { country: "Mauritius", shortName: "MU" },
        { country: "Mexico", shortName: "MX" },
        { country: "Micronesia", shortName: "FM" },
        { country: "Moldova", shortName: "MD" },
        { country: "Monaco", shortName: "MC" },
        { country: "Mongolia", shortName: "MN" },
        { country: "Montenegro", shortName: "ME" },
        { country: "Morocco", shortName: "MA" },
        { country: "Mozambique", shortName: "MZ" },
        { country: "Myanmar", shortName: "MM" },
        { country: "Namibia", shortName: "NA" },
        { country: "Nauru", shortName: "NR" },
        { country: "Nepal", shortName: "NP" },
        { country: "Netherlands", shortName: "NL" },
        { country: "New Zealand", shortName: "NZ" },
        { country: "Nicaragua", shortName: "NI" },
        { country: "Niger", shortName: "NE" },
        { country: "Nigeria", shortName: "NG" },
        { country: "North Macedonia", shortName: "MK" },
        { country: "Norway", shortName: "NO" },
        { country: "Oman", shortName: "OM" },
        { country: "Pakistan", shortName: "PK" },
        { country: "Palau", shortName: "PW" },
        { country: "Panama", shortName: "PA" },
        { country: "Papua New Guinea", shortName: "PG" },
        { country: "Paraguay", shortName: "PY" },
        { country: "Peru", shortName: "PE" },
        { country: "Philippines", shortName: "PH" },
        { country: "Poland", shortName: "PL" },
        { country: "Portugal", shortName: "PT" },
        { country: "Qatar", shortName: "QA" },
        { country: "Romania", shortName: "RO" },
        { country: "Russia", shortName: "RU" },
        { country: "Rwanda", shortName: "RW" },
        { country: "Saint Kitts and Nevis", shortName: "KN" },
        { country: "Saint Lucia", shortName: "LC" },
        { country: "Saint Vincent and the Grenadines", shortName: "VC" },
        { country: "Samoa", shortName: "WS" },
        { country: "San Marino", shortName: "SM" },
        { country: "Sao Tome and Principe", shortName: "ST" },
        { country: "Saudi Arabia", shortName: "SA" },
        { country: "Senegal", shortName: "SN" },
        { country: "Serbia", shortName: "RS" },
        { country: "Seychelles", shortName: "SC" },
        { country: "Sierra Leone", shortName: "SL" },
        { country: "Singapore", shortName: "SG" },
        { country: "Slovakia", shortName: "SK" },
        { country: "Slovenia", shortName: "SI" },
        { country: "Solomon Islands", shortName: "SB" },
        { country: "Somalia", shortName: "SO" },
        { country: "South Africa", shortName: "ZA" },
        { country: "South Sudan", shortName: "SS" },
        { country: "Spain", shortName: "ES" },
        { country: "Sri Lanka", shortName: "LK" },
        { country: "Sudan", shortName: "SD" },
        { country: "Suriname", shortName: "SR" },
        { country: "Sweden", shortName: "SE" },
        { country: "Switzerland", shortName: "CH" },
        { country: "Syria", shortName: "SY" },
        { country: "Taiwan", shortName: "TW" },
        { country: "Tajikistan", shortName: "TJ" },
        { country: "Tanzania", shortName: "TZ" },
        { country: "Thailand", shortName: "TH" },
        { country: "Timor-Leste", shortName: "TL" },
        { country: "Togo", shortName: "TG" },
        { country: "Tonga", shortName: "TO" },
        { country: "Trinidad and Tobago", shortName: "TT" },
        { country: "Tunisia", shortName: "TN" },
        { country: "Turkey", shortName: "TR" },
        { country: "Turkmenistan", shortName: "TM" },
        { country: "Tuvalu", shortName: "TV" },
        { country: "Uganda", shortName: "UG" },
        { country: "Ukraine", shortName: "UA" },
        { country: "United Arab Emirates", shortName: "AE" },
        { country: "United Kingdom", shortName: "GB" },
        { country: "United States", shortName: "US" },
        { country: "Uruguay", shortName: "UY" },
        { country: "Uzbekistan", shortName: "UZ" },
        { country: "Vanuatu", shortName: "VU" },
        { country: "Vatican City", shortName: "VA" },
        { country: "Venezuela", shortName: "VE" },
        { country: "Vietnam", shortName: "VN" },
        { country: "Yemen", shortName: "YE" },
        { country: "Zambia", shortName: "ZM" },
        { country: "Zimbabwe", shortName: "ZW" },
      ],
      required: true,
    },
    state: {
      type: String,
      enum: [
        {
          country: "NG",
          states: [
            "Abia",
            "Adamawa",
            "Akwa Ibom",
            "Anambra",
            "Bauchi",
            "Bayelsa",
            "Benue",
            "Borno",
            "Cross River",
            "Delta",
            "Ebonyi",
            "Edo",
            "Ekiti",
            "Enugu",
            "Gombe",
            "Imo",
            "Jigawa",
            "Kaduna",
            "Kano",
            "Katsina",
            "Kebbi",
            "Kogi",
            "Kwara",
            "Lagos",
            "Nasarawa",
            "Niger",
            "Ogun",
            "Ondo",
            "Osun",
            "Oyo",
            "Plateau",
            "Rivers",
            "Sokoto",
            "Taraba",
            "Yobe",
            "Zamfara",
          ],
        },
        {
          country: "US",
          states: ["California", "Texas", "New York", "Florida", "Illinois"],
        },
      ],
      required: true,
    },
    localGovernmentArea: {
      type: String,
      enum: [
        {
          state: "Lagos",
          LGAs: [
            "Ikeja",
            "Lagos Mainland",
            "Badagry",
            "Shomolu",
            "Agege",
            "Kosofe",
            "Surulere",
            "Mushin",
            "Ikorodu",
            "Amuwo Odofin",
            "Alimosho",
            "Apapa",
            "Eti Osa",
            "Lagos Island",
            "Ojo",
          ],
        },
        {
          state: "Abuja",
          LGAs: ["Abuja Municipal", "Kuje", "Gwagwalada", "Bwari", "Kwali"],
        },
      ],
      required: true,
    },
    age: {
      type: String,
      required: true,
      enum: [
        "15-20",
        "21-25",
        "26-30",
        "31-35",
        "36-40",
        "41-45",
        "46-50",
        "51-55",
        "56-60",
        "61-65",
        "66-70",
        "71-100",
      ],
    },
    gender: {
      type: String,
      required: true,
      enum: ["Male", "Female"],
    },
    ageRange: {
      type: String,
      enum: [
        "15-20",
        "21-25",
        "26-30",
        "31-35",
        "36-40",
        "41-45",
        "46-50",
        "51-55",
        "56-60",
        "61-65",
        "66-70",
        "71-100",
      ],
      required: true,
    },
    relationshipStatus: {
      type: String,
      enum: ["single", "married", "separated", "widow"],
      required: true,
    },
    phoneNumber: {
      type: String,
      match: [
        /^\+234\d{10}$/,
        "Please provide a valid Nigerian phone number starting with +234",
      ],
      required: [true, "Phone number is required"],
    },

    email: {
      type: String,
      required: true,
      unique: true,
      match: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
    },
    password: {
      type: String,
      required: true,
    },
    idType: {
      type: String,
      enum: ["NIN", "BVN"],
      required: true,
    },
    ninNumber: {
      type: String,
      minlength: 11,
      match: [/^[0-9]{11}$/, "NIN number must be exactly 11 digits"],
      required: false,
    },
    bvnNumber: {
      type: String,
      minlength: 11,
      match: [/^[0-9]{11}$/, "BVN number must be exactly 11 digits"],
      required: false,
    },
    conditionalValidation: {
      type: Object,
      properties: {
        ninNumber: {
          type: string,
          required: false,
        },
        bvnNumber: {
          type: string,
          required: false,
        },
      },
      required: true,
      if: {
        properties: {
          idType: { const: "NIN" },
        },
        then: {
          properties: {
            ninNumber: { type: "string" },
            bvnNumber: { type: "null" },
          },
        },
        else: {
          properties: {
            ninNumber: { type: "null" },
            bvnNumber: { type: "string" },
          },
        },
      },
    },
    avatar: {
      type: String,
      default: "https://cdn-icons-png.flaticon.com/512/9131/9131529.png",
    },
  },
  {
    timestamps: true,
  }
);
const AgentUser = mongoose.model("AgentUser", agentSchema);

export default AgentUser;


      idType: {
        type: String,
        required: true,
        enum: ["NIN", "BVN"],
      },
      ninNumber: {
        type: String,
        unique: true,
        required: function () {
          return this.idType === "NIN";  // Only required if idType is NIN
        },
      },
      bvnNumber: {
        type: String,
        unique: true,
        required: function () {
          return this.idType === "BVN";  // Only required if idType is BVN
        },
      },


      ninNumber: {
      type: String,
      match: [/^[0-9]{11}$/, "NIN number must be exactly 11 digits"],
      validate: {
        validator: function (v) {
          return this.idType === "NIN" ? !!v : true;
        },
        message: "NIN number is required when idType is 'NIN'",
      },
      sparse: true,
    },
    bvnNumber: {
      type: String,
      match: [/^[0-9]{11}$/, "BVN number must be exactly 11 digits"],
      validate: {
        validator: function (v) {
          return this.idType === "BVN" ? !!v : true;
        },
        message: "BVN number is required when idType is 'BVN'",
      },
      sparse: true, 
    },